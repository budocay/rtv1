var mlj_pixel_put,mlj_clear_window,mlj_key_hook,mlj_init,mlj_new_window,mlj_mouse_hook,mlj_upload_button,mlj_new_image,mlj_put_image_to_window,mlj_loop_hook,mlj_loop,mlj_xpm_file_to_image;
(function(){function x(a,b){var d=b||window.event,c=g[f.KEYBOARD];c&&c.func(d.keyCode,c.params)}function r(a){var b={which:a.which,clientX:null,clientY:null};!a.which&&a.button&&(a.button&1?b.which=1:a.button&4?b.which=2:a.button&2&&(b.which=3));b.clientX=a.clientX?a.clientX:a.x;b.clientY=a.clientY?a.clientY:a.y;return b}function t(a){a=a||window.event;var b=g[f.MOUSE];a.preventDefault&&a.preventDefault();a=r(a);b&&b.func(a.which,a.clientX,a.clientY,b.params)}function y(a){new x(keyType.KEYUP,a)}
function z(a){a=a||window.event;r(a);a=a.target.files[0];var b=new FileReader,d=g[f.UPLOAD];b.onloadend=function(a){d.func(a.target.result,d.params)};b.readAsText(a)}function A(){var a=g[f.LOOP];a&&a.func(a.params)}var f={KEYBOARD:0,MOUSE:1,UPLOAD:2,LOOP:3};var g=[],u=0,v=0,p="#000000";mlj_key_hook=function(a,b){g[f.KEYBOARD]={func:a,params:b}};mlj_mouse_hook=function(a,b){g[f.MOUSE]=
{func:a,params:b}};mlj_new_window=function(a,b,d,c){var e;e=document.createElement("canvas");e.id="undefined"!==typeof c?c:"e_win";e.width=a;e.height=b;document.body.appendChild(e);c=e.getContext("2d");u=a;v=b;p="undefined"!==typeof d?d:p;c.fillStyle=p;c.fillRect(0,0,a,b);return c};mlj_init=function(a){document.title="undefined"!==typeof a?a:"MinilibJS";window.addEventListener("keydown",y,!1);window.addEventListener("contextmenu",t,!1);window.addEventListener("mousedown",t,!1)};mlj_pixel_put=function(a,
b,d,c){a.fillStyle=c;a.fillRect(b,d,1,1)};mlj_upload_button=function(a,b,d,c){c="undefined"!==typeof c?d:"files";d=document.getElementById("undefined"!==typeof d?d:"body");var e=document.createElement("input");e.type="file";e.id=c;e.name="files[]";d.appendChild(e);e.addEventListener("change",z,!1);g[f.UPLOAD]={func:a,params:b}};mlj_clear_window=function(a){a.clearRect(0,0,u,v)};mlj_new_image=function(a,b,d){return a.getImageData(0,0,b,d)};mlj_put_image_to_window=function(a,b,d,c){a.putImageData(b,
d,c)};mlj_loop_hook=function(a,b){g[f.LOOP]={func:a,params:b}};mlj_loop=function(){setInterval(A,16)};var w;(function(){function a(a){return parseInt(a,16)}w=function(b,d,c,e){for(var g=null,s=null,m=null,f=[],q=[],m=/([0-9]+) ([0-9]+) ([0-9]+) ([0-9]+)/g.exec(b),g=m[1],s=m[2],m=m[4],n=new RegExp("(.{"+m+"}) c ((#[0-9a-fA-F]{6}|None))","g"),l=[],f={};l=n.exec(b);)f[l[1]]=l[2],q.push(l[1].replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"));g="undefined"==typeof c?c:g;s="undefined"==typeof e?e:s;
n=[];e=0;for(c=new RegExp('[^"]{'+g*m+"}","g");e<s;){n=c.exec(b);q=0;for(n=n[0];q<g&&n;){var k=n.substring(0,m),l=d,p=q,r=e,h=void 0,h=f[k],k=[];"None"==h?k=[0,0,0,0]:(h=h.substring(1),k[0]=a(h.substring(0,2)),k[1]=a(h.substring(2,4)),k[2]=a(h.substring(4)),k[3]=255);h=4*(r*l.img.width+p);l.img.data[h++]=k[0];l.img.data[h++]=k[1];l.img.data[h++]=k[2];l.img.data[h]=k[3];n=n.substring(m);++q}++e}}})();mlj_xpm_file_to_image=function(a,b,d,c,e,g){var f={win:a,img:null};f.img=mlj_new_image(f.win,b,d);
w(c,f,b,d);e(a,f.img,g)}})();
